<style>
  .inline-links {
    display: none;
  }

  .mk-raindrop-bookmarks {
    display: flex;
    flex-wrap: wrap;
    justify-content: space-between;
    margin: 0 auto;
    box-shadow: none;
    transition: none;
    overflow-x: hidden;
    max-width: 100%;
  }

  .mk-raindrop-bookmark {
    width: 100%;
    margin: 0 auto;
    border-top: var(--border-top);
  }

  .mk-raindrop-bookmark:hover {
    text-decoration: none;
    box-shadow: none;
    border-top: 0.5px solid var(--code-bg);
    --bookmark-list-opacity: 1;
    background-color: rgb(250 250 250 / var(--bookmark-list-opacity));
    border-radius: var(--radius);
  }

  .dark .mk-raindrop-bookmark:hover {
    text-decoration: none;
    box-shadow: none;
    border-top: 0.5px solid var(--code-bg);
    border-radius: var(--radius);
    --bookmark-list-opacity: 0.1;
    background-color: rgb(0 0 0 / var(--bookmark-list-opacity));
  }

  .mk-raindrop-bookmark:hover + .mk-raindrop-bookmark {
    border-top: 0.5px solid var(--code-bg);
  }

  .mk-raindrop-bookmark a {
    text-decoration: none;
    color: inherit;
    display: block;
    box-shadow: none;
    padding: 1rem 0.5rem;
  }

  .mk-raindrop-bookmark a:hover {
    text-decoration: none;
    box-shadow: none;
    padding: 1rem 0.5rem;
  }

  .mk-title-wrapper {
    display: inline-flex;
    align-items: flex-start;
    position: relative;
    justify-content: flex-start;
  }

  .mk-title {
    font-size: 16px;
    font-weight: 500;
    background-repeat: no-repeat;
    background-position: left center;
    background-size: 16px;
    line-height: 1.5rem;
    color: var(--content);
    transition: 0.5s;
    margin-left: 26px;
  }

  .mk-raindrop-bookmark:hover .mk-title {
    color: var(--content);
    box-shadow: 0 1px 0 var(--content);
  }

  .mk-avatar {
    width: 16px;
    height: 16px;
    background-size: cover;
    background-position: center;
    margin-right: 10px;
    border-radius: 2px;
    margin-top: 0.3rem;
    position: absolute;
  }

  .mk-excerpt {
    font-size: 14px;
    line-height: 1.6;
    color: var(--secondary);
    overflow: hidden;
    text-overflow: ellipsis;
    padding-left: 26px;
    margin: 0.2rem 0 0.2rem 0;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .mk-raindrop-tags {
    display: flex;
    flex-wrap: wrap;
    padding: 0;
    margin: 0.5rem 0 0 0;
    padding-left: 26px;
    align-items: center;
    gap: 0.5rem;
  }

  .mk-tag {
    display: inline-block;
    color: var(--secondary);
    font-size: 12px;
    white-space: nowrap;
    line-height: 1.4rem;
  }

  .mk-divider {
    /* width: 100%;
    background-color: var(--tertiary-bg);
    border-bottom: 0.5px solid var(--tertiary-bg);
    opacity: .65; */
    display: none;
  }

  .mk-svg {
    margin-left: 0;
    opacity: 0;
    position: absolute;
    right: -20px;
    transform: translateX(20px);
    transition: all 0.2s ease;
    display: flex;
    justify-content: center;
  }

  .mk-raindrop-bookmark:hover .mk-svg {
    opacity: 1;
    transform: translateX(0);
  }

  .mk-tab {
    display: flex;
    flex-wrap: wrap;
    gap: 0.6rem;
    padding-bottom: 1.5rem;
  }

  .mk-tab-tag {
    display: inline-block;
    color: var(--secondary);
    background: linear-gradient(
        180deg,
        rgba(223, 225, 231, 0) 0%,
        rgba(223, 225, 231, 0.05) 100%
      ),
      var(--entry);
    box-shadow: 0px 1px 2px rgba(42, 59, 81, 0.12),
      0px 0px 0px 1px rgba(18, 55, 105, 0.08);
    border-radius: 6px;
    padding: 0.05rem 0.5rem;
    font-size: 13px;
    white-space: nowrap;
    line-height: 1.4rem;
    cursor: pointer;
  }

  .mk-tab-tag.mk-tab-tag-active:hover {
    color: rgba(255, 255, 255, 0.9);
    background-color: var(--link-hover-color);
  }

  .dark .mk-tab-tag-active {
    box-shadow: none;
  }

  .mk-tab-tag:hover {
    color: var(--secondary);
    background-color: var(--code-bg);
  }

  .mk-tab-tag-active {
    color: rgba(255, 255, 255, 0.9);
    background: linear-gradient(
        180deg,
        rgba(255, 255, 255, 0.16) 0%,
        rgba(255, 255, 255, 0) 100%
      ),
      #009999;
    box-shadow: 0px 1px 2px rgba(0, 80, 80, 0.4),
      0px 0px 0px 1px rgba(0, 122, 122, 0.76);
    border-radius: 6px;
  }

  .mk-update-time {
    margin-left: auto;
    opacity: 0.7;
    color: var(--tertiary);
    font-size: 12px;
    white-space: nowrap;
    line-height: 1.4rem;
  }

  .mk-tag.mk-update-time {
    background-color: unset;
  }

  span.mk-important-description {
    margin-left: auto;
    color: var(--link-hover-color);
    font-size: 12px;
    white-space: nowrap;
    line-height: 1.4rem;
    margin-right: 0.5rem;
  }

  .mk-important {
    display: flex;
    align-items: center;
    gap: 2px;
  }
  .mk-raindrop-bookmark.important {
    background-color: rgb(198 239 239 / 25%);
  }

  .mk-raindrop-bookmark.important:hover {
    background-color: rgb(198 239 239 / 40%);
  }

  .dark .mk-raindrop-bookmark.important {
    background-color: rgb(26 55 55 / 30%);
  }

  .dark .mk-raindrop-bookmark.important:hover {
    background-color: rgba(30, 65, 65, 0.3);
  }
</style>

<script async>
  const apiUrl =
    "https://api.raindrop.io/rest/v1/raindrops/34199304?access_token=d7e078a0-3f49-4419-981a-8695c399b0d8&perpage=100&sort=-created";
  fetch(apiUrl)
    .then((response) => response.json())
    .then((data) => {
      const bookmarksContainer = document.querySelector(
        ".mk-raindrop-bookmarks"
      );
      let html = "";
      data.items.forEach((item) => {
        const domain = item.link.match(/\/\/([^/]+)/)[1];
        const tagsHtml = item.tags
          .map((tag) => `<div class="mk-tag">${tag}</div>`)
          .join("");
        const importantHtml = item.important
          ? `<span class="mk-important-description">很赞</span>`
          : "";

        html += `
      <div class="mk-raindrop-bookmark">
        <a href="${item.link}" target="_blank" rel="noopener noreferrer">
          <div class="mk-title-wrapper">
            <div class="mk-avatar" style="background-image: url('https://unavatar.io/${domain}'); background-size: 16px 16px;"></div>
            <div class="mk-title">${item.title}</div>
            <div class="mk-svg">→</div>
          </div>
          ${item.excerpt ? `<div class="mk-excerpt">${item.excerpt}</div>` : ""}
          <div class="mk-raindrop-tags">
            ${tagsHtml}
            <divider></divider>
            <div class="mk-tag mk-update-time">${item.lastUpdate}</div>
            <spacer></spacer>
            <div class="mk-important">${importantHtml}</div>
          </div>
        </a>
      </div>
      <div class="mk-divider"></div>
    `;
      });

      bookmarksContainer.innerHTML = html;

      // 过滤掉重复的tag
      const tags = document.querySelectorAll(".mk-tab-tag");
      const tagList = [];
      tags.forEach((tag) => {
        if (tagList.indexOf(tag.innerHTML) === -1) {
          tagList.push(tag.innerHTML);
        } else {
          tag.style.display = "none";
        }
      });

      // 显示所有书签
      function showAll() {
        const bookmarks = document.querySelectorAll(".mk-raindrop-bookmark");
        bookmarks.forEach((bookmark) => (bookmark.style.display = "block"));

        const tags = document.querySelectorAll(".mk-tab-tag");
        tags.forEach((tag) => tag.classList.remove("mk-tab-tag-active"));

        document
          .querySelector(".mk-tab-tag")
          .classList.add("mk-tab-tag-active");
      }

      // 根据tag显示书签
      function showTag(tag) {
        const bookmarks = document.querySelectorAll(".mk-raindrop-bookmark");
        bookmarks.forEach((bookmark) => {
          const tags = bookmark.querySelectorAll(".mk-tag");
          if (tags.length > 0) {
            let found = false;
            tags.forEach((tagElement) => {
              if (tagElement.innerHTML === tag) {
                found = true;
              }
            });

            if (found) {
              bookmark.style.display = "block";
            } else {
              bookmark.style.display = "none";
            }
          } else {
            bookmark.style.display = "none";
          }
        });

        const tags = document.querySelectorAll(".mk-tab-tag");
        tags.forEach((tagElement) => {
          if (tagElement.innerHTML === tag) {
            tagElement.classList.add("mk-tab-tag-active");
          } else {
            tagElement.classList.remove("mk-tab-tag-active");
          }
        });
      }

      // 标记important的书签
      const bookmarks = document.querySelectorAll(".mk-raindrop-bookmark");
      bookmarks.forEach((bookmark) => {
        const important = bookmark.querySelector(".mk-important-description");
        if (important) {
          bookmark.classList.add("important");
        }
      });

      // 格式化lastUpdate的时间
      const lastUpdate = document.querySelectorAll(".mk-update-time");
      lastUpdate.forEach((time) => {
        const date = new Date(time.innerHTML);
        const now = new Date();
        const diff = now.getTime() - date.getTime();
        const days = Math.floor(diff / (24 * 3600 * 1000));
        const leave1 = diff % (24 * 3600 * 1000);
        const hours = Math.floor(leave1 / (3600 * 1000));
        const leave2 = leave1 % (3600 * 1000);
        const minutes = Math.floor(leave2 / (60 * 1000));
        const leave3 = leave2 % (60 * 1000);
        const seconds = Math.round(leave3 / 1000);
        let output = "";

        if (days > 0) {
          output = `${days} 天前`;
        } else if (hours > 0) {
          output = `${hours} 小时前`;
        } else if (minutes > 0) {
          output = `${minutes} 分钟前`;
        } else if (seconds > 0) {
          output = `${seconds} 秒前`;
        }

        const months = Math.floor(days / 30);
        const years = Math.floor(days / 365);
        if (months > 0) {
          output = `${months} 月前`;
        } else if (years > 0) {
          output = `${years} 年前`;
        }

        time.innerHTML = output;
      });

      // 初始化标签第一个为active状态
      document
        .querySelector(".mk-tab-tag:first-child")
        .classList.add("mk-tab-tag-active");
    });
</script>
